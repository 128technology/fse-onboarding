{"body":"{% editgroup %}\n{\n  \"authority\": {\n    \"name\": \"{{variables['authority_name']}}\",\n    \"conductor-address\": [\n      \"{{variables['conductor_address']}}\"\n    ],\n    \"dnsAppId\": {\n      \"generateServices\": \"true\",\n      \"baseService\": \"l3nid-outbound\"\n    },\n    \"router\": [\n      {\n        \"name\": \"{{variables.dc_router['routerName']}}\",\n        \"location\": \"{{variables.dc_router['location']}}\",\n        \"locationCoordinates\": \"{{variables.dc_router['locationCoordinates']}}\",\n        \"routerGroup\": [\n          \"datacenter\"\n        ],\n        \"interNodeSecurity\": \"{{variables.dc_router['interNodeSecurity']}}\",\n        \"node\": [\n          {\n            \"name\": \"node1\",\n            \"role\": \"combo\",\n            \"deviceInterface\": [\n              {\n                \"name\": \"mgmt\",\n                \"pciAddress\": \"{{variables.dc_router['mgmt_pciAddress']}}\",\n                \"forwarding\": \"false\",\n                \"networkInterface\": [\n                  {\n                    \"name\": \"mgmt\",\n                    \"address\": [\n                      {\n                        \"ipAddress\": \"{{variables.dc_router['mgmt_ipAddress']}}\",\n                        \"prefixLength\": \"{{variables.dc_router['mgmt_prefixLength']}}\",\n                        \"gateway\": \"{{variables.dc_router['mgmt_gateway']}}\"\n                      }\n                    ],\n                    \"defaultRoute\": \"true\",\n                    \"managementVector\": {\n                      \"name\": \"provider\",\n                      \"priority\": \"100\"\n                    }\n                  }\n                ]\n              },\n              {\n                \"name\": \"wan\",\n                \"pciAddress\": \"{{variables.dc_router['wan_pciAddress']}}\",\n                \"networkInterface\": [\n                  {\n                    \"name\": \"wan\",\n                    \"address\": [\n                      {\n                        \"ipAddress\": \"{{variables.dc_router['wan_ipAddress']}}\",\n                        \"prefixLength\": \"{{variables.dc_router['wan_prefixLength']}}\",\n                        \"gateway\": \"{{variables.dc_router['wan_gateway']}}\"\n                      }\n                    ],\n                    \"sourceNat\": \"true\",\n                    \"conductor\": \"true\",\n                    \"interRouterSecurity\": \"{{variables.dc_router['interRouterSecurity']}}\",\n                    \"neighborhood\": [\n                      {\n                        \"name\": \"{{variables.dc_router['neighborhood_name']}}\",\n                        \"topology\": \"hub\",\n                        \"pathMtuDiscovery\": {\n                          \"enabled\": \"true\"\n                        }\n                      }\n                    ]\n                  }\n                ]\n              },\n              {\n                \"name\": \"lan\",\n                \"pciAddress\": \"{{variables.dc_router['lan_pciAddress']}}\",\n                \"networkInterface\": [\n                  {\n                    \"name\": \"lan\",\n                    \"tenant\": \"{{variables['management_tenant']}}\",\n                    \"address\": [\n                      {\n                        \"ipAddress\": \"{{variables.dc_router['lan_ipAddress']}}\",\n                        \"prefixLength\": \"{{variables.dc_router['lan_prefixLength']}}\"\n                      }\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"reverseSsh\": {}\n          }\n        ],\n        \"dnsConfig\": [\n          {\n            \"mode\": \"static\",\n            \"address\": [\n              {%- for address in variables.dc_router['dns_servers'] %}\n              \"{{ address }}\"{% if forloop.last == false %},{% endif %}\n              {%- endfor %}\n            ]\n          }\n        ],\n        \"system\": {\n          \"ntp\": {\n            \"server\": [\n              {%- for address in variables.dc_router['ntp_servers'] %}\n              {\n                \"ipAddress\": \"{{ address }}\"\n              }{% if forloop.last == false %},{% endif %}\n              {%- endfor %}\n            ]\n          }\n        },\n        \"serviceRoute\": []\n      }\n    ],\n    \"tenant\": [\n      {\n        \"name\": \"{{variables['management_tenant']}}\"\n      }\n    ],\n    \"service\": [\n      {\n        \"name\": \"l3nid-inbound\",\n        \"shareServiceRoutes\": \"false\",\n        \"address\": [\n          \"0.0.0.0/0\"\n        ],\n        \"accessPolicy\": [\n          {\n            \"source\": \"_internal_\"\n          }\n        ]\n      },\n      {\n        \"name\": \"l3nid-outbound\",\n        \"address\": [\n          \"0.0.0.0/0\"\n        ],\n        \"shareServiceRoutes\": \"false\",\n        \"sourceNat\": \"disabled\",\n        \"accessPolicy\": [\n          {\n            \"source\": \"_internal_\"\n          }\n        ],\n        \"generateCategories\": \"true\"\n      },\n      {\n        \"name\": \"M365-Common.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-Common\"\n        ]\n      },\n      {\n        \"name\": \"M365-Exchange.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-Exchange\"\n        ]\n      },\n      {\n        \"name\": \"M365-SharePoint.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-SharePoint\"\n        ]\n      },\n      {\n        \"name\": \"M365-Skype.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-Skype\"\n        ]\n      }\n    ]\n  }\n}"}