{
  "body": "{% editgroup %}\n{\n  \"authority\": {\n    \"name\": \"{{ authority_name.value }}\",\n    \"conductor-address\": [\n      \"{{ conductor_address.value }}\"\n    ],\n    \"dnsAppId\": {\n      \"generateServices\": \"true\",\n      \"baseService\": \"l3nid-outbound\"\n    },\n    \"router\": [\n      {\n        \"name\": \"conductor\",\n        \"location\": \"{{ location.value }}\",\n        \"locationCoordinates\": \"{{ locationCoordinates.value }}\",\n        \"system\": {\n          \"ntp\": {\n            \"server\": [\n              {%- for address in ntp_servers.value %}\n              {\n                \"ipAddress\": \"{{ address }}\"\n              }{% if forloop.last == false %},{% endif %}\n              {%- endfor %}\n            ]\n          }\n        },\n        \"node\": [\n          {\n            \"name\": \"node1\",\n            \"assetId\": \"conductor\"\n          }\n        ]\n      },\n      {\n        \"name\": \"{{ routerName.value }}\",\n        \"location\": \"{{ location.value }}\",\n        \"locationCoordinates\": \"{{ locationCoordinates.value }}\",\n        \"routerGroup\": [\n          \"datacenter\"\n        ],\n        \"interNodeSecurity\": \"{{ interNodeSecurity.value }}\",\n        \"node\": [\n          {\n            \"name\": \"node1\",\n            \"assetId\": \"l3niddc\",\n            \"role\": \"combo\",\n            \"deviceInterface\": [\n              {\n                \"name\": \"mgmt\",\n                \"pciAddress\": \"{{ mgmt_pciAddress.value }}\",\n                \"forwarding\": \"false\",\n                \"networkInterface\": [\n                  {\n                    \"name\": \"mgmt\",\n                    \"address\": [\n                      {\n                        \"ipAddress\": \"{{ mgmt_ipAddress.value }}\",\n                        \"prefixLength\": \"{{ mgmt_prefixLength.value }}\",\n                        \"gateway\": \"{{ mgmt_gateway.value }}\"\n                      }\n                    ],\n                    \"defaultRoute\": \"true\",\n                    \"managementVector\": {\n                      \"name\": \"provider\",\n                      \"priority\": \"10\"\n                    }\n                  }\n                ]\n              },\n              {\n                \"name\": \"wan\",\n                \"pciAddress\": \"{{ wan_pciAddress.value }}\",\n                \"networkInterface\": [\n                  {\n                    \"name\": \"wan\",\n                    \"address\": [\n                      {\n                        \"ipAddress\": \"{{ wan_ipAddress.value }}\",\n                        \"prefixLength\": \"{{ wan_prefixLength.value }}\",\n                        \"gateway\": \"{{ wan_gateway.value }}\"\n                      }\n                    ],\n                    \"sourceNat\": \"true\",\n                    \"conductor\": \"true\",\n                    \"interRouterSecurity\": \"{{ interRouterSecurity.value }}\",\n                    \"neighborhood\": [\n                      {\n                        \"name\": \"{{ neighborhood_name.value }}\",\n                        \"topology\": \"hub\",\n                        \"external-nat-address\": \"{{ wan_floating_ip.value }}\",\n                        \"pathMtuDiscovery\": {\n                          \"enabled\": \"true\"\n                        }\n                      }\n                    ]\n                  }\n                ]\n              },\n              {\n                \"name\": \"lan\",\n                \"pciAddress\": \"{{ lan_pciAddress.value }}\",\n                \"networkInterface\": [\n                  {\n                    \"name\": \"lan\",\n                    \"tenant\": \"{{ management_tenant.value }}\",\n                    \"address\": [\n                      {\n                        \"ipAddress\": \"{{ lan_ipAddress.value }}\",\n                        \"prefixLength\": \"{{ lan_prefixLength.value }}\"\n                      }\n                    ]\n                  }\n                ]\n              }\n            ],\n            \"reverseSsh\": {}\n          }\n        ],\n        \"dnsConfig\": [\n          {\n            \"mode\": \"static\",\n            \"address\": [\n              {%- for address in dns_servers.value %}\n              \"{{ address }}\"{% if forloop.last == false %},{% endif %}\n              {%- endfor %}\n            ]\n          }\n        ],\n        \"system\": {\n          \"ntp\": {\n            \"server\": [\n              {%- for address in ntp_servers.value %}\n              {\n                \"ipAddress\": \"{{ address }}\"\n              }{% if forloop.last == false %},{% endif %}\n              {%- endfor %}\n            ]\n          }\n        },\n        \"serviceRoute\": []\n      }\n    ],\n    \"tenant\": [\n      {\n        \"name\": \"{{ management_tenant.value }}\"\n      },\n      {\n        \"name\": \"_internal_\"\n      }\n    ],\n    \"service\": [\n      {\n        \"name\": \"l3nid-inbound\",\n        \"shareServiceRoutes\": \"false\",\n        \"address\": [\n          \"0.0.0.0/0\"\n        ],\n        \"accessPolicy\": [\n          {\n            \"source\": \"_internal_\"\n          }\n        ]\n      },\n      {\n        \"name\": \"l3nid-outbound\",\n        \"address\": [\n          \"0.0.0.0/0\"\n        ],\n        \"shareServiceRoutes\": \"false\",\n        \"sourceNat\": \"disabled\",\n        \"accessPolicy\": [\n          {\n            \"source\": \"_internal_\"\n          }\n        ],\n        \"generateCategories\": \"true\"\n      },\n      {\n        \"name\": \"M365-Common.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-Common\"\n        ]\n      },\n      {\n        \"name\": \"M365-Exchange.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-Exchange\"\n        ]\n      },\n      {\n        \"name\": \"M365-SharePoint.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-SharePoint\"\n        ]\n      },\n      {\n        \"name\": \"M365-Skype.l3nid-outbound\",\n        \"applicationName\": [\n          \"O365-Skype\"\n        ]\n      }\n    ]\n  }\n}\n"
}